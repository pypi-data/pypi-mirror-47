---
#######################################################################
#
#   SECRETS DEFINITIONS
#
#   Note that the Secrets extension depends on the Deployment
#   extension and that for each declared environment a vault
#   is created.
#
#######################################################################
secrets:
  # Specifies the default ownership for secrets. Choose from 'repository'
  # (repository owns secrets) or 'ops' (operations owns secrets).
  {%- if spec.secrets.default_ownership %}
  default_ownership: {{ spec.secrets.default_ownership }}
  {%- else %}
  default_ownership: repo
  {%- endif %}

  # Specifies which PGP keys may open the vault.
  {%- if spec.secrets.allowed_keys %}
  allowed_keys:
  {%- for key in spec.secrets.allowed_keys %}
  - {{ key }}
  {%- endfor %}
  {%- else %}
  allowed_keys: []
  {%- endif %}

  # Configures the vault options for each environment.
  {%- if spec.secrets.vaults %}
  vaults:
    {{ spec.secrets.vaults|yaml|indent(4) }}
  {%- else %}
  vaults: {}
  {%- endif %}
