{% extends edc_listboard_template %}

{% load edc_dashboard_extras %}
{% load tz %}
{% load static %}


{% block listboard_table_header %}

    <!-- begin results header -->
    <th>#</th>
    <th></th>
    <th>Subject</th>
    <th>AE</th>
    <th>Parent</th>
    <th>Follow-ups</th>
    <th>Death Report</th>
    <th>Created</th>
    <th>Modified</th>
    <!-- end results header -->

{% endblock listboard_table_header %}

{% block listboard_table_button_column %}
    <td nowrap>
       <a title="Edit AE Initial" href="{{ result.ae_initial.href }}" class="btn btn-default btn-sm"><i class="fas fa-pencil-alt fa-fw"></i></a>
       <a title="Print AE Initial" href="?pdf={{result.action_identifier}}" class="btn btn-default btn-sm"><i class="fas fa-file-pdf fa-fw"></i></a>
    </td>
{% endblock %}

{% block listboard_table_columns %}

    <td>{{ result.subject_identifier }}</td>

    <td>{{ result.reference_model_name }}
        <br><span class="text text-muted small">{{ utc_date|timeuntil:result.report_datetime.date }} ago</span>
    </td>

    <td>{{ result.parent_reference_model_name|default:"" }}</td>

    <td>{% for obj in result.reference_obj.ae_follow_ups %}<p>AE Followup {{ obj }}</p>{% endfor %}</td>

    {% if result.death_report.id %}
        <td><a href="{% url 'ambition_dashboard:death_report_listboard_url' %}?q={{result.subject_identifier }}">{{ result.death_report.object.identifier }}</a></td>
    {% else %}
        <td></td>
    {% endif %}

    <td>{{ result.reference_obj.user_created|default:"---" }}<BR>{{ result.reference_obj.created|date:"SHORT_DATETIME_FORMAT"|default:"---" }}</td>

    <td>{{ result.reference_obj.user_modified|default:"---" }}<BR>{{ result.reference_obj.modified|date:"SHORT_DATETIME_FORMAT"|default:"---" }}</td>

{% endblock listboard_table_columns %}
