FROM sadm

LABEL maintainer="Jerem√≠as Casteglione <jrmsdev@gmail.com>"
LABEL version="0.2"

USER root:root

ENV DEBIAN_FRONTEND noninteractive

RUN echo 'Acquire::http::proxy "http://localhost:3142";' >/etc/apt/apt.conf.d/02proxy

RUN apt-get clean
RUN apt-get update

RUN apt-get dist-upgrade -y --purge
RUN apt-get install -y --no-install-recommends python3-pip vim-tiny

COPY venv/requirements-test.txt /tmp
COPY venv/requirements.txt /tmp

RUN pip3 install -r /tmp/requirements-test.txt
RUN pip3 install -r /tmp/requirements.txt

RUN apt-get clean
RUN apt-get autoremove -y --purge

RUN rm -rf /var/lib/apt/lists/*
RUN rm -f /var/cache/apt/archives/*.deb
RUN rm -f /var/cache/apt/*cache.bin

RUN rm -rf /root/.cache

RUN echo '%sadm ALL=NOPASSWD: ALL' >/etc/sudoers.d/sadm

USER sadm:sadm
WORKDIR /opt/src/sadm

CMD /bin/bash
