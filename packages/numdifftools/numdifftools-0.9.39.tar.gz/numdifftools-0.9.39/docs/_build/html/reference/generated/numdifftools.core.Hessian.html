

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>5.1.1.5. numdifftools.core.Hessian &mdash; Numdifftools 0.9.39 documentation</title>
  

  
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="../../genindex.html"/>
        <link rel="search" title="Search" href="../../search.html"/>
    <link rel="top" title="Numdifftools 0.9.39 documentation" href="../../index.html"/>
        <link rel="up" title="5.1. Numdifftools summary" href="../numdifftools_summary.html"/> 

  
  <script src="../../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../../index.html" class="icon icon-home"> Numdifftools
          

          
          </a>

          
            
            
              <div class="version">
                0.9.39
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../intro/index.html">1. Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tutorials/index.html">2. Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../how-to/index.html">3. How-to guides</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../topics/index.html">4. Topics guides</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">5. Reference</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="../numdifftools_summary.html">5.1. Numdifftools summary</a><ul class="current">
<li class="toctree-l3 current"><a class="reference internal" href="../numdifftools_summary.html#numdifftools-core-module">5.1.1. numdifftools.core module</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="numdifftools.core.Derivative.html">5.1.1.1. numdifftools.core.Derivative</a></li>
<li class="toctree-l4"><a class="reference internal" href="numdifftools.core.Gradient.html">5.1.1.2. numdifftools.core.Gradient</a></li>
<li class="toctree-l4"><a class="reference internal" href="numdifftools.core.Jacobian.html">5.1.1.3. numdifftools.core.Jacobian</a></li>
<li class="toctree-l4"><a class="reference internal" href="numdifftools.core.Hessdiag.html">5.1.1.4. numdifftools.core.Hessdiag</a></li>
<li class="toctree-l4 current"><a class="current reference internal" href="#">5.1.1.5. numdifftools.core.Hessian</a></li>
<li class="toctree-l4"><a class="reference internal" href="numdifftools.core.directionaldiff.html">5.1.1.6. numdifftools.core.directionaldiff</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../numdifftools_summary.html#step-generators">5.1.2. Step generators</a></li>
<li class="toctree-l3"><a class="reference internal" href="../numdifftools_summary.html#numdifftools-extrapolation-module">5.1.3. numdifftools.extrapolation module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../numdifftools_summary.html#numdifftools-limits-module">5.1.4. numdifftools.limits module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../numdifftools_summary.html#numdifftools-multicomplex-module">5.1.5. numdifftools.multicomplex module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../numdifftools_summary.html#numdifftools-nd-algopy-module">5.1.6. numdifftools.nd_algopy module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../numdifftools_summary.html#numdifftools-nd-scipy-module">5.1.7. numdifftools.nd_scipy module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../numdifftools_summary.html#numdifftools-nd-statsmodels-module">5.1.8. numdifftools.nd_statsmodels module</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../numdifftools.html">5.2. Numdifftools package details</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../appendix/changelog.html">Changelog</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../appendix/authors.html">Contributors</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../appendix/license.html">License</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../appendix/acknowledgement.html">Acknowledgments</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../appendix/index.html">Indices and tables</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../appendix/bibliography.html">Bibliography</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Numdifftools</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../index.html">5. Reference</a> &raquo;</li>
        
          <li><a href="../numdifftools_summary.html">5.1. Numdifftools summary</a> &raquo;</li>
        
      <li>5.1.1.5. numdifftools.core.Hessian</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../_sources/reference/generated/numdifftools.core.Hessian.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="numdifftools-core-hessian">
<h1>5.1.1.5. numdifftools.core.Hessian<a class="headerlink" href="#numdifftools-core-hessian" title="Permalink to this headline">¶</a></h1>
<dl class="class">
<dt id="numdifftools.core.Hessian">
<em class="property">class </em><code class="descname">Hessian</code><span class="sig-paren">(</span><em>f</em>, <em>step=None</em>, <em>method='central'</em>, <em>order=2</em>, <em>full_output=False</em>, <em>**step_options</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/numdifftools/core.html#Hessian"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#numdifftools.core.Hessian" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate Hessian with finite difference approximation</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>fun</strong> <span class="classifier-delimiter">:</span> <span class="classifier">function</span></dt>
<dd><p class="first last">function of one array fun(x, <cite>*args</cite>, <cite>**kwds</cite>)</p>
</dd>
<dt><strong>step</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float, array-like or StepGenerator object, optional</span></dt>
<dd><p class="first">Defines the spacing used in the approximation.
Default is MinStepGenerator(base_step=step, step_ratio=None,</p>
<blockquote>
<div><p>num_extrap=0, <a href="#id1"><span class="problematic" id="id2">**</span></a>step_options)</p>
</div></blockquote>
<p>if step or method in in [‘complex’, ‘multicomplex’],
otherwise</p>
<blockquote>
<div><p>MaxStepGenerator(step_ratio=None, num_extrap=14, <a href="#id3"><span class="problematic" id="id4">**</span></a>step_options)</p>
</div></blockquote>
<p class="last">The results are extrapolated if the StepGenerator generate more than 3
steps.</p>
</dd>
<dt><strong>method</strong> <span class="classifier-delimiter">:</span> <span class="classifier">{‘central’, ‘complex’, ‘multicomplex’, ‘forward’, ‘backward’}</span></dt>
<dd><p class="first last">defines the method used in the approximation</p>
</dd>
<dt><strong>full_output</strong> <span class="classifier-delimiter">:</span> <span class="classifier">bool, optional</span></dt>
<dd><p class="first last">If <cite>full_output</cite> is False, only the derivative is returned.
If <cite>full_output</cite> is True, then (der, r) is returned <cite>der</cite> is the
derivative, and <cite>r</cite> is a Results object.</p>
</dd>
<dt><strong>**step_options:</strong></dt>
<dd><p class="first last">options to pass on to the XXXStepGenerator used.</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>hess</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray</span></dt>
<dd><p class="first last">array of partial second derivatives, Hessian</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="../test.html#numdifftools.core.Derivative" title="numdifftools.core.Derivative"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Derivative</span></code></a>, <a class="reference internal" href="../test.html#numdifftools.core.Hessian" title="numdifftools.core.Hessian"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Hessian</span></code></a></p>
</div>
<p class="rubric">Notes</p>
<p>Complex methods are usually the most accurate provided the function to
differentiate is analytic. The complex-step methods also requires fewer
steps than the other methods and can work very close to the support of
a function.
The complex-step derivative has truncation error O(steps**2) for <cite>n=1</cite> and
O(steps**4) for <cite>n</cite> larger, so truncation error can be eliminated by
choosing steps to be very small.
Especially the first order complex-step derivative avoids the problem of
round-off error with small steps because there is no subtraction. However,
this method fails if fun(x) does not support complex numbers or involves
non-analytic functions such as e.g.: abs, max, min.
Central difference methods are almost as accurate and has no restriction on
type of function. For this reason the ‘central’ method is the default
method, but sometimes one can only allow evaluation in forward or backward
direction.</p>
<p>For all methods one should be careful in decreasing the step size too much
due to round-off errors.</p>
<p>Computes the Hessian according to method as:
‘forward’ <a class="reference internal" href="#equation-7">(5.1)</a>, ‘central’ <a class="reference internal" href="#equation-9">(5.2)</a> and ‘complex’ <a class="reference internal" href="#equation-10">(5.3)</a>:</p>
<div class="math notranslate nohighlight" id="equation-7">
<span class="eqno">(5.1)<a class="headerlink" href="#equation-7" title="Permalink to this equation">¶</a></span>\[\quad ((f(x + d_j e_j + d_k e_k) - f(x + d_j e_j))) / (d_j d_k)\]</div>
<div class="math notranslate nohighlight" id="equation-9">
<span class="eqno">(5.2)<a class="headerlink" href="#equation-9" title="Permalink to this equation">¶</a></span>\[\quad  ((f(x + d_j e_j + d_k e_k) - f(x + d_j e_j - d_k e_k)) -
        (f(x - d_j e_j + d_k e_k) - f(x - d_j e_j - d_k e_k)) /
        (4 d_j d_k)\]</div>
<div class="math notranslate nohighlight" id="equation-10">
<span class="eqno">(5.3)<a class="headerlink" href="#equation-10" title="Permalink to this equation">¶</a></span>\[imag(f(x + i d_j e_j + d_k e_k) - f(x + i d_j e_j - d_k e_k)) /
    (2 d_j d_k)\]</div>
<p>where <span class="math notranslate nohighlight">\(e_j\)</span> is a vector with element <span class="math notranslate nohighlight">\(j\)</span> is one and the rest
are zero and <span class="math notranslate nohighlight">\(d_j\)</span> is a scalar spacing <span class="math notranslate nohighlight">\(steps_j\)</span>.</p>
<p class="rubric">References</p>
<dl class="docutils">
<dt>Ridout, M.S. (2009) Statistical applications of the complex-step method</dt>
<dd>of numerical differentiation. The American Statistician, 63, 66-74</dd>
<dt>K.-L. Lai, J.L. Crassidis, Y. Cheng, J. Kim (2005), New complex step</dt>
<dd>derivative approximations with application to second-order
kalman filtering, AIAA Guidance, Navigation and Control Conference,
San Francisco, California, August 2005, AIAA-2005-5944.</dd>
<dt>Lyness, J. M., Moler, C. B. (1966). Vandermonde Systems and Numerical</dt>
<dd>Differentiation. <em>Numerische Mathematik</em>.</dd>
<dt>Lyness, J. M., Moler, C. B. (1969). Generalized Romberg Methods for</dt>
<dd>Integrals of Derivatives. <em>Numerische Mathematik</em>.</dd>
</dl>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numdifftools</span> <span class="k">as</span> <span class="nn">nd</span>
</pre></div>
</div>
<p># Rosenbrock function, minimized at [1,1]</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">rosen</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="p">(</span><span class="mf">1.</span><span class="o">-</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">105</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Hfun</span> <span class="o">=</span> <span class="n">nd</span><span class="o">.</span><span class="n">Hessian</span><span class="p">(</span><span class="n">rosen</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">h</span> <span class="o">=</span> <span class="n">Hfun</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">h</span>
<span class="go">array([[ 842., -420.],</span>
<span class="go">       [-420.,  210.]])</span>
</pre></div>
</div>
<p># cos(x-y), at (0,0)</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">cos</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fun</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">xy</span> <span class="p">:</span> <span class="n">cos</span><span class="p">(</span><span class="n">xy</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="n">xy</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Hfun2</span> <span class="o">=</span> <span class="n">nd</span><span class="o">.</span><span class="n">Hessian</span><span class="p">(</span><span class="n">fun</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">h2</span> <span class="o">=</span> <span class="n">Hfun2</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">h2</span>
<span class="go">array([[-1.,  1.],</span>
<span class="go">       [ 1., -1.]])</span>
</pre></div>
</div>
<p class="rubric">Methods</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><code class="xref py py-obj docutils literal notranslate"><span class="pre">__call__</span></code>(x,&nbsp;*args,&nbsp;**kwds)</td>
<td>Call self as a function.</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="numdifftools.core.Hessian.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>f</em>, <em>step=None</em>, <em>method='central'</em>, <em>order=2</em>, <em>full_output=False</em>, <em>**step_options</em><span class="sig-paren">)</span><a class="headerlink" href="#numdifftools.core.Hessian.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize self.  See help(type(self)) for accurate signature.</p>
</dd></dl>

<p class="rubric">Methods</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="#numdifftools.core.Hessian.__init__" title="numdifftools.core.Hessian.__init__"><code class="xref py py-obj docutils literal notranslate"><span class="pre">__init__</span></code></a>(f[,&nbsp;step,&nbsp;method,&nbsp;order,&nbsp;full_output])</td>
<td>Initialize self.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="../numdifftools.html#numdifftools.core.Hessian.set_richardson_rule" title="numdifftools.core.Hessian.set_richardson_rule"><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_richardson_rule</span></code></a>(step_ratio[,&nbsp;num_terms])</td>
<td></td>
</tr>
</tbody>
</table>
<p class="rubric">Attributes</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="../numdifftools.html#numdifftools.core.Hessian.n" title="numdifftools.core.Hessian.n"><code class="xref py py-obj docutils literal notranslate"><span class="pre">n</span></code></a></td>
<td></td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="../numdifftools.html#numdifftools.core.Hessian.order" title="numdifftools.core.Hessian.order"><code class="xref py py-obj docutils literal notranslate"><span class="pre">order</span></code></a></td>
<td></td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="../numdifftools.html#numdifftools.core.Hessian.step" title="numdifftools.core.Hessian.step"><code class="xref py py-obj docutils literal notranslate"><span class="pre">step</span></code></a></td>
<td></td>
</tr>
</tbody>
</table>
</dd></dl>

</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2009-2019, Per A Brodtkorb, , John D&#39;Errico.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../',
            VERSION:'0.9.39',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../../_static/jquery.js"></script>
      <script type="text/javascript" src="../../_static/underscore.js"></script>
      <script type="text/javascript" src="../../_static/doctools.js"></script>
      <script type="text/javascript" src="../../_static/language_data.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="../../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>